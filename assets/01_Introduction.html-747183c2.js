import{_ as n,W as t,X as e,a1 as l,Y as a,Z as s}from"./framework-4b60d352.js";const m={},i=l('<h1 id="_1-介绍" tabindex="-1"><a class="header-anchor" href="#_1-介绍" aria-hidden="true">#</a> 1 介绍</h1><p>计算机图形学这一术语描述了任何使用计算机来创建和操纵图像的行为。本书介绍了能用于创建任何类型图像（如真实的视觉效果，信息丰富的技术插图和漂亮的电脑动画）的算法和数学工具。图形学可以是二维或三维的；图像可以是完全合成的也可以通过操纵照片来生成的。本书主要与基本算法和数学有关，特别是那些用于生成三维对象和场景的合成图像的算法。</p><p>实际上学习计算机图形学不可避免地需要了解特定的硬件，文件格式和一到两个图像学 API（见 Section 1.3）。计算机图形学是一个快速发展的领域，所以具体的知识也在不断地变化。因此，在本书中我们会尽可能地避免依赖于特定的硬件或 API。我们鼓励读者自行补充自己的软件或硬件环境下的相关知识。幸运的是，计算机图形学已经拥有了足够的标准术语和概念，因此本书中的概念和讨论能够很好地映射到大部分环境中。</p><p>本章节定义了一些基本术语，并提供了一些历史背景，以及和计算机图形学相关的信息来源。</p><h2 id="_1-1-图形学领域" tabindex="-1"><a class="header-anchor" href="#_1-1-图形学领域" aria-hidden="true">#</a> 1.1 图形学领域</h2><p>对任何领域强行施加类别都是危险的，但是 大部分图形学从业者都会对下面提到的图形学的主要领域达成一致：</p><ul><li><strong>建模</strong> 主要是指一种能把形状以及表现特性以数学描述的方式存储在计算机上的方法。例如，一个咖啡杯可能被描述为一系列有序的 3D 点并以一些插值规则来连接这些点，除此之外还需要一个反射模型来描述光线如何在被子上进行放射。</li><li><strong>渲染</strong> 是一个从艺术领域继承过来的术语，用于处理如何从 3D 计算机模型中创建着色图像。</li><li><strong>动画</strong> 是一个通过连续的图像来创建运动的错觉的技术。动画不仅使用了建模和渲染，还添加了随时间运动的关键问题，这通常不会在基础的建模和渲染中被处理。</li></ul><p>其他的许多领域也涉及到计算机图形学，但它们是否是计算机图形学的核心领域则是一个仁者见仁的问题。这些都会在本书中至少被提及。这些相关的领域包括这些：</p><ul><li><strong>用户交互</strong> 处理的是输入设备比如鼠标和键盘与应用程序之间的交互接口，应用程序会通过画面改变的方式来反馈给用户输入结果。历史上这个领域广泛地和图形学联系在一起是因为图形学研究者最早接触到了现在无所不在的输入/输出设别。</li><li><strong>虚拟现实</strong> 试图将用户沉浸在 3D 虚拟世界。这通常至少需要立体图形学和对头部动作进行返回。对于真正的虚拟现实来说，声音和压力反馈也应该被提供。因为这个领域需要先进的 3D 图形学和先进的展示技术，这通常和图形学紧密相关。</li><li><strong>可视化</strong> 试图通过视觉现实使用户深入了解复杂信息。通常在可视化问题中需要解决图形学问题。</li><li><strong>图像处理</strong> 解决 2D 图像的操纵问题，并用于图形学和视觉领域。</li><li><strong>三维扫描</strong> 使用范围查找技术来创建被测量的 3D 模型。这样的模型对于创建丰富的视觉图像很有用，并且此类模型的处理通常需要图形学算法。</li><li><strong>计算机摄影学</strong> 是使用计算机图形学，计算机视觉和图像处理方法来实现一种新的为物体，场景以及环境进行摄影的方法。</li></ul><h2 id="_1-2-主要应用" tabindex="-1"><a class="header-anchor" href="#_1-2-主要应用" aria-hidden="true">#</a> 1.2 主要应用</h2><p>几乎所有领域都能利用计算机图形学，但是计算机图形学的主要使用者包括以下行业：</p><ul><li><strong>电子游戏</strong> 不断增加了对复杂 3D 模型和渲染算法的使用。</li><li><strong>卡通动画</strong> 经常直接使用 3D 模型进行渲染。大部分传统 2D 动画使用的背景是从 3D 模型中渲染得到的，这允许在在不需要话费大量画师时间的条件下创建连续移动视角动画。</li><li><strong>视觉效果</strong> 使用几乎所有类型的计算机图形学技术。几乎所有的现代电影使用数字合成的方式来使用分离的电影前景叠加到背景中。许多电影也允许使用 3D 模型和动画来创建合成的环境，对象甚至是角色，并且大部分观影者不会怀疑这是不真实的。</li><li><strong>动画电影</strong> 使用和视觉效果一样的相同的技术，但是不必关注图像是否真实。</li><li><strong>CAD/CAM</strong> 是计算机辅助设计（compute-aided design）和计算机辅助操纵（computer-aided manfacturing）的缩写。这些领域会使用计算机技术在计算机上设计组件和产品，并且接下来使用这些虚拟技术来指导生产过程。例如许多机械零件都是在 3D 计算机建模软件中设计的，并在计算机控制的铣削设备上自动生产。</li><li><strong>仿真模拟</strong> 可以被认为是一个准确的视频游戏。例如，一个飞行模拟器使用复杂的 3D 图形学技术来模拟驾驶一架飞机的体验。这样的仿真模拟对于在安全至关重要的领域（如驾驶）的初次训练中非常有用。对于那些在现实中红需大量花费和危险的领域（如特定的消防情况），即使是有经验的用户也可以使用仿真模拟进行场景培训。</li><li><strong>医学图像</strong> 从扫描的患者数据中创建有意义的图像。例如，计算机断层成像（CT）数据集由包含密度值的的大型 3D 矩形数组组成的。计算机图形学被用于创建阴影图像来帮助医生从这些数据中提取最突出的信息。</li><li><strong>数据可视化</strong> 创建数据的图像，这些图像不一定有=拥有正常的自然的视觉描述。例如十支不同股票价格的时间趋势并没有明显的视觉描述，但是巧妙的图形技术能够帮助人们看到这些数据的模式。</li></ul><h2 id="_1-3-图形学-api" tabindex="-1"><a class="header-anchor" href="#_1-3-图形学-api" aria-hidden="true">#</a> 1.3 图形学 API</h2><p>使用图形库的关键部分是处理图形 API。一个应用程序接口（API）是一组执行一系列相关操作的函数的标准集合，并且一个图形学 API 是一组能够在屏幕上执行基本操作（如绘制图像和 3D 表面）的函数。</p><p>每个图形学程序都需要能够使用两个相关的 API，一个图形学 API 用于视觉输出，另一个用户接口 API 用于获取用户的输入。当前有两种主流的图形学和用户交互 API 的范式。第一种是综合方法，比如说 Java。在 Java 中，图形学工具和用户交互工具是集成和组件化的包，作为语言的一部分被完全标准化和支持。第二种的代表是 Direct3D 和 OpenGL。在这里绘制命令是一门语言（如C++）的软件库的一部分，并且用户交互软件是一个独立的部分，可能因系统而异。在后一种方法中，编写可移植的代码往往充满问题，虽然对于简单的程序来说，它可能使用一个可移植的库莱封装系统特定的用户交互代码。</p><p>无论你选择哪种 API，基础的图形学命令通常都会是相同的，并且本书中的概念也将会得到应用。</p><h2 id="_1-4-图形管线" tabindex="-1"><a class="header-anchor" href="#_1-4-图形管线" aria-hidden="true">#</a> 1.4 图形管线</h2><p>现在每个桌面电脑都拥有高性能的 3D 图形管线。这是一个特殊的软/硬件子系统，能够有效地绘制透视的 3D 图元。通常这些系统对使用共享顶点来处理 3D 三角形的过程进行了优化。管线中的基本操作是将 3D 顶点坐标映射到 2D 屏幕坐标，渲染三角形来让它们看起来真实并且以正确的前后顺序出现。</p><p>虽然以有效的前后顺序来绘制三角形曾经在计算机图形学中是最重要的研究问题，但是几乎已经被使用 z-buffer 的方式解决了，它使用了一个特殊的内存缓冲简单粗暴地解决了这个问题。</p>',19),r=a("p",null,[s("事实证明，图形管线中使用的几何操纵几乎可以完全在四维坐标空间中被完成，该空间由三个传统的集合坐标和第四个用于辅助透视视角的齐次坐标。这些 4D 坐标使用 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mn",null,"4"),a("mo",null,"×"),a("mn",null,"4")]),a("annotation",{encoding:"application/x-tex"},"4 \\times 4")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"4"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"×"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"4")])])]),s(" 矩阵和 4-向量进行计算。因此图形管线拥有大量的高效处理和生成这些矩阵和向量的硬件装置。4D 坐标系是计算机科学中最精妙和最漂亮的结构之一，因此当学习计算机图形学时，这无疑是需要跨越的最大知识障碍。每一本图形学书籍的第一部分都有很大一部分用于讲解如何处理这些坐标。")],-1),c=a("p",null,"图像被生成的速度很大程度上取决于被绘制的三角形的数量。由于在许多应用中交互性比视觉效果更加重要，因此值得使用尽可能少的三角形来表现一个模型。此外，如果在远处观察模型，比从近处观察模型需要更少的三角形。这表明了使用不同细节等级（LOD）来表示模型是有效的。",-1),p=a("h2",{id:"_1-5-数值问题",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_1-5-数值问题","aria-hidden":"true"},"#"),s(" 1.5 数值问题")],-1),o=a("p",null,"许多图形学程序实际上知识 3D 数值的代码。通常数值问题在这些程序中至关重要。以前，很难用鲁棒且轻便的方法来处理这些问题，因为每台机器对于数字有不同的内部表达，更糟糕的是它们使用不完全且不兼容的方法来处理异常。幸运的是，几乎所有的现代计算机都符合 IEEE 浮点数标准（IEEE Standards Association, 1985）。这允许程序员对关于如何处理某些数字条件做出许多方便的假设。",-1),h=a("p",null,"虽然当编码数值算法时，IEEE 浮点数标准有许多有价值的特性，但是对于图形学中的大部分场景中只有少数几个是至关重要的。第一点也是最重要的是，理解 IEEE 浮点数标准中实数的三个特殊值：",-1),d=a("ol",null,[a("li",null,[a("strong",null,[s("正无穷（"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞")])])]),s("）。")]),s(" 这是一个比所有其他有效数字都大的有效数字。")]),a("li",null,[a("strong",null,[s("负无穷（"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"-\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞")])])]),s("）。")]),s(" 这是一个比所有其他有效数字都小的有效数字。")]),a("li",null,[a("strong",null,[s("不是一个数字（"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s("）。")]),s(" 这是一个无效数字，它是由具有未定义结果的操作产生的，例如零除以零。")])],-1),g=a("p",null,[s("IEEE 浮点数标准的设计者做出了一些对于程序员非常方便的决定。当处理异常的时候喝多都和上述三个特殊值有关，例如除以零。在这些情况下一个异常会被记录，但是大部分情况下程序员能忽略它。特别是对于任何一个正实数 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a")]),a("annotation",{encoding:"application/x-tex"},"a")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a")])])]),s("，在涉及到除以无穷时有以下规则：")],-1),u=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mo",null,"+"),a("mi",null,"a"),a("mi",{mathvariant:"normal"},"/"),a("mo",{stretchy:"false"},"("),a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("mo",null,"+"),a("mn",null,"0")]),a("annotation",{encoding:"application/x-tex"}," +a/(+\\infty)=+0 ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord"},"/"),a("span",{class:"mopen"},"("),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞"),a("span",{class:"mclose"},")"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"0")])])])])],-1),x=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mo",null,"−"),a("mi",null,"a"),a("mi",{mathvariant:"normal"},"/"),a("mo",{stretchy:"false"},"("),a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("mo",null,"−"),a("mn",null,"0")]),a("annotation",{encoding:"application/x-tex"}," -a/(+\\infty)=-0 ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord"},"/"),a("span",{class:"mopen"},"("),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞"),a("span",{class:"mclose"},")"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"0")])])])])],-1),y=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mo",null,"+"),a("mi",null,"a"),a("mi",{mathvariant:"normal"},"/"),a("mo",{stretchy:"false"},"("),a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("mo",null,"−"),a("mn",null,"0")]),a("annotation",{encoding:"application/x-tex"}," +a/(-\\infty)=-0 ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord"},"/"),a("span",{class:"mopen"},"("),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞"),a("span",{class:"mclose"},")"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"0")])])])])],-1),w=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mo",null,"−"),a("mi",null,"a"),a("mi",{mathvariant:"normal"},"/"),a("mo",{stretchy:"false"},"("),a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞"),a("mo",{stretchy:"false"},")"),a("mo",null,"="),a("mo",null,"+"),a("mn",null,"0")]),a("annotation",{encoding:"application/x-tex"}," -a/(-\\infty)=+0 ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord"},"/"),a("span",{class:"mopen"},"("),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞"),a("span",{class:"mclose"},")"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"0")])])])])],-1),k=a("p",null,[s("其他涉及到无穷的规则表现的和你预想的一样。还是正数 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a")]),a("annotation",{encoding:"application/x-tex"},"a")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a")])])]),s("，有以下的规则：")],-1),b=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"="),a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"}," \\infty + \\infty = +\\infty ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"∞"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"+"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞")])])])])],-1),v=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"="),a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"}," \\infty - \\infty = NaN ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"∞"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"−"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])])])],-1),M=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"×"),a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"="),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"}," \\infty \\times \\infty = \\infty ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"∞"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"×"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞")])])])])],-1),_=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞"),a("mi",{mathvariant:"normal"},"/"),a("mi",{mathvariant:"normal"},"∞"),a("mo",null,"="),a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"}," \\infty / \\infty = NaN ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"∞/∞"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])])])],-1),f=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞"),a("mi",{mathvariant:"normal"},"/"),a("mi",null,"a"),a("mo",null,"="),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"}," \\infty / a = \\infty ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"∞/"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞")])])])])],-1),N=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞"),a("mi",{mathvariant:"normal"},"/"),a("mn",null,"0"),a("mo",null,"="),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"}," \\infty / 0 = \\infty ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"∞/0"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞")])])])])],-1),L=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mn",null,"0"),a("mi",{mathvariant:"normal"},"/"),a("mn",null,"0"),a("mo",null,"="),a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"}," 0 / 0 = NaN ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"0/0"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])])])],-1),E=a("p",null,"涉及到无穷值的布尔表达式的规则正如预期的那样：",-1),D=a("ol",null,[a("li",null,[s("所有的有限值都小于 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"+\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞")])])]),s("。")]),a("li",null,[s("所有的有限值都大于 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"-\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞")])])]),s("。")]),a("li",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"-\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞")])])]),s(" 小于 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"+\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞")])])]),s("。")])],-1),I=a("p",null,[s("涉及到具有 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s(" 值的表达式的规则很简单：")],-1),P=a("ol",null,[a("li",null,[s("任何涉及到 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s(" 的数值表达式的结果都是 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s("。")]),a("li",null,[s("任何涉及到 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s(" 的布尔表达式的结果都是 false。")])],-1),A=a("p",null,[s("也许 IEEE 浮点数标准最具价值的部分是当除以零时如何处理；对于任何正实数 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a")]),a("annotation",{encoding:"application/x-tex"},"a")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a")])])]),s(" 来说如果涉及到除以零有如下规则：")],-1),z=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mo",null,"+"),a("mi",null,"a"),a("mi",{mathvariant:"normal"},"/"),a("mo",null,"+"),a("mn",null,"0"),a("mo",null,"="),a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"}," +a / +0 = +\\infty ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord"},"/"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"+"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"0"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞")])])])])],-1),G=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mo",null,"−"),a("mi",null,"a"),a("mi",{mathvariant:"normal"},"/"),a("mo",null,"+"),a("mn",null,"0"),a("mo",null,"="),a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"}," -a / +0 = -\\infty ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord"},"/"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"+"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"0"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞")])])])])],-1),C=a("p",null,"如果程序员能利用好 IEEE 规则，许多数值计算都会变得更加简单。例如，思考下面这个表达式：",-1),B=a("p",{class:"katex-block"},[a("span",{class:"katex-display"},[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a"),a("mo",null,"="),a("mfrac",null,[a("mn",null,"1"),a("mrow",null,[a("mfrac",null,[a("mn",null,"1"),a("mi",null,"b")]),a("mo",null,"+"),a("mfrac",null,[a("mn",null,"1"),a("mi",null,"c")])])])]),a("annotation",{encoding:"application/x-tex"}," a = \\frac{1}{\\frac{1}{b}+\\frac{1}{c}} ")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"2.4015em","vertical-align":"-1.0801em"}}),a("span",{class:"mord"},[a("span",{class:"mopen nulldelimiter"}),a("span",{class:"mfrac"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"1.3214em"}},[a("span",{style:{top:"-2.2649em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"mord"},[a("span",{class:"mord"},[a("span",{class:"mopen nulldelimiter"}),a("span",{class:"mfrac"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.8451em"}},[a("span",{style:{top:"-2.655em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mtight"},[a("span",{class:"mord mathnormal mtight"},"b")])])]),a("span",{style:{top:"-3.23em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),a("span",{style:{top:"-3.394em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mtight"},[a("span",{class:"mord mtight"},"1")])])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.345em"}},[a("span")])])])]),a("span",{class:"mclose nulldelimiter"})]),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"+"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mord"},[a("span",{class:"mopen nulldelimiter"}),a("span",{class:"mfrac"},[a("span",{class:"vlist-t vlist-t2"},[a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.8451em"}},[a("span",{style:{top:"-2.655em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mtight"},[a("span",{class:"mord mathnormal mtight"},"c")])])]),a("span",{style:{top:"-3.23em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),a("span",{style:{top:"-3.394em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"sizing reset-size6 size3 mtight"},[a("span",{class:"mord mtight"},[a("span",{class:"mord mtight"},"1")])])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"0.345em"}},[a("span")])])])]),a("span",{class:"mclose nulldelimiter"})])])]),a("span",{style:{top:"-3.23em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),a("span",{style:{top:"-3.677em"}},[a("span",{class:"pstrut",style:{height:"3em"}}),a("span",{class:"mord"},[a("span",{class:"mord"},"1")])])]),a("span",{class:"vlist-s"},"​")]),a("span",{class:"vlist-r"},[a("span",{class:"vlist",style:{height:"1.0801em"}},[a("span")])])])]),a("span",{class:"mclose nulldelimiter"})])])])])])],-1),R=a("p",null,[s("这样的表达式常出现在电阻和透镜中。如果除以零导致了一个程序崩溃（在 IEEE 浮点数标准之前经常出现在许多系统中），接下来就需要两个 if 表达式来确认 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"b")]),a("annotation",{encoding:"application/x-tex"},"b")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6944em"}}),a("span",{class:"mord mathnormal"},"b")])])]),s(" 或 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"c")]),a("annotation",{encoding:"application/x-tex"},"c")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"c")])])]),s(" 是非常小的值或零。在 IEEE 浮点数标准下，如果 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"b")]),a("annotation",{encoding:"application/x-tex"},"b")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6944em"}}),a("span",{class:"mord mathnormal"},"b")])])]),s(" 或 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"c")]),a("annotation",{encoding:"application/x-tex"},"c")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"c")])])]),s(" 是零，我们将和预期一样直接得到一个零值。避免特殊检查的一个常用技术是利用好 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s(" 的布尔特性。考虑以下代码片段：")],-1),S=l(`<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>a = f(x)
if a&gt;0 then
    do something
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),V=a("p",null,[s("在这里，函数 f 可能返回许多奇怪的值，例如 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord"},"∞")])])]),s(" 或 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s("，但是 if 语句的条件仍能很好地被定义：如果 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a"),a("mo",null,"="),a("mi",null,"N"),a("mi",null,"a"),a("mi",null,"N")]),a("annotation",{encoding:"application/x-tex"},"a = NaN")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6833em"}}),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N"),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"N")])])]),s(" 或 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a"),a("mo",null,"="),a("mo",null,"−"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"a = -\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"−"),a("span",{class:"mord"},"∞")])])]),s("，条件将会是 false，如果 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mi",null,"a"),a("mo",null,"="),a("mo",null,"+"),a("mi",{mathvariant:"normal"},"∞")]),a("annotation",{encoding:"application/x-tex"},"a = +\\infty")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4306em"}}),a("span",{class:"mord mathnormal"},"a"),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),a("span",{class:"mrel"},"="),a("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6667em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"+"),a("span",{class:"mord"},"∞")])])]),s("，条件将会是 true。在确定返回哪些值时要注意，通常 if 语句能做出正确的选择，而无需进行特殊的检查。这让程序变得更加简介，更加鲁棒，也更加高效。")],-1),H=l('<h2 id="_1-6-效率" tabindex="-1"><a class="header-anchor" href="#_1-6-效率" aria-hidden="true">#</a> 1.6 效率</h2><p>这里没有使代码更加高效的神奇规则。通过仔细地权衡能实现提高效率，对于不同的架构来说权衡的方案也有所不同。但是对于可预见的未来，一个好的启发是，程序员应该更关注内存访问模式而不是操作数。这与二十年前的最好的启发相反。因为内存的速度并没有和处理器的速度保持同步，所以导致了这种转变的发生。随着这一趋势的发展，有限且一致的内存访问对于对于优化的重要性只会增加。</p><p>使代码更快的一个明智的方法是按照接下来的顺序采取所需要的步骤：</p><ol><li>使用最直接的方法编写代码。根据需要计算中间结果而不是存储它们。</li><li>以 optimized 模式进行编译。</li><li>使用任何存在的 profiling 工具来找到关键的性能瓶颈。</li><li>检查数据结构找到提升局部性的方法。如果可能的话，让数据单元尺寸和目标架构上的的内存或页面尺寸相匹配。</li><li>如果 profiling 检测出性能瓶颈出现在数值计算中，检查编译器生成的汇编代码来查找影响性能的地方。重写源代码来解决你发现的问题。</li></ol><p>在这些步骤中第一步最重要。大部分“优化操作”不仅不能给代码加速，也让代码更难以被阅读。除此之外，通常提前花费在优化代码上的时间用在修复 bug 或添加功能上更好。另外请当心那些从老书上的建议；一些传统的技巧例如使用整数代替真实的浮点数数不再能提升速度，因为现代 CPU 通常可以像执行整数操作一样快地执行浮点数操作。在所有场景中，都需要 profiling 工具来保证在特定机器或编译器上优化措施是有效的。</p><h2 id="_1-7-设计和编码图形学程序" tabindex="-1"><a class="header-anchor" href="#_1-7-设计和编码图形学程序" aria-hidden="true">#</a> 1.7 设计和编码图形学程序</h2><p>在图形学编程中某些常见的策略通常是有效的。在本节中我们将提供一些建议，当你实现你在本书中学到的方法时，你会发现这些建议非常有效。</p><h3 id="_1-7-1-类设计" tabindex="-1"><a class="header-anchor" href="#_1-7-1-类设计" aria-hidden="true">#</a> 1.7.1 类设计</h3><p>任何图形程序中的关键部分都是拥有良好设计的类或程序来组织例如向量或矩阵这样的几何实体，或者是例如 RGB 颜色和图像这样的图形实体。这些程序应该尽可能的简洁高效。一个常见的设计问题是位置和位移是非应该是单独的类，因为它们有着不同的操作，例如一个位置乘以二分之一没有几何意义，但是一个位移的二分之一有（Goldman, 1985; DeRose, 1989）。在这个问题上仍有许多争论，这可能会引发图形学从业者之间数个小时的争论，但是为了示例，假设我们不会对此作出区分。</p><p>这意味着要编写的一些基础类包括：</p>',10),T=a("ul",null,[a("li",null,[a("strong",null,"vector2。"),s(" 一个存储了 x 和 y 方向上分量的 2D 向量类。它应该将这些组件存储在一个长度为2的数组里，以便能够很好地支持索引操作。你还应该添加向量的加，减，点乘，叉乘，标量乘法和标量除法操作。")]),a("li",null,[a("strong",null,"vector3。"),s(" 一个类似于 vector2 的 3D 向量类。")]),a("li",null,[a("strong",null,"hvector。"),s(" 一个包含了四个分量的齐次向量（见 Chapter 7）。")]),a("li",null,[a("strong",null,"rgb。"),s(" 一个存储了三个分量的 RGB 颜色。你也应该添加 RGB 的加，减，乘，标量乘法和标量除法操作。")]),a("li",null,[a("strong",null,"transform。"),s(" 一个用于变换的 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mn",null,"4"),a("mo",null,"×"),a("mn",null,"4")]),a("annotation",{encoding:"application/x-tex"},"4 \\times 4")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),a("span",{class:"mord"},"4"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),a("span",{class:"mbin"},"×"),a("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.6444em"}}),a("span",{class:"mord"},"4")])])]),s(" 矩阵。你应该添加一个矩阵乘法和用于位置，方向和表面法线的成员函数。就像第6章展示的那样，这些都是不同的。")]),a("li",null,[a("strong",null,"image。"),s(" 带有输出操作的 RGB 像素的 2D 阵列。")])],-1),q=l(`<p>另外，你可能想也可能不想添加关于间隔，正交基和坐标系框架的类。</p><h3 id="_1-7-2-单精度-vs-双精度" tabindex="-1"><a class="header-anchor" href="#_1-7-2-单精度-vs-双精度" aria-hidden="true">#</a> 1.7.2 单精度 vs. 双精度</h3><p>现代架构表明降低内存的使用率和保持连贯的内存访问是提高效率的关键。这建议我们使用单精度数据。然而为了避免数值问题建议使用精度算法。权衡的结果取决于程序本身，但是最好在你的类中拥有默认的选择结果。</p><h3 id="_1-7-3-调试图形学程序" tabindex="-1"><a class="header-anchor" href="#_1-7-3-调试图形学程序" aria-hidden="true">#</a> 1.7.3 调试图形学程序</h3><p>如果你四处打听，你可能会发现随着程序员经验越来越丰富，他们就会更少地使用传统的调试器。一个原因是相比于简单程序，对复杂程序使用此类调试器会更加不方便。一个其他的原因是最困难的错误是那些错误的事情正在被执行的概念错误，并且很容易花费大量的时间在变量值上步进却没有检测到这种情况。我们发现一些调试策略在图形学中十分有效。</p><p><strong>科学方法</strong></p><p>在图形程序中有一种相比于传统调试的替代方法通常是非常有用。不利的一面是，这与计算机程序员被教导的在他们职业生涯早期不要做的事情非常相似，如果你这样做了你可能会感觉有些“淘气”：我们将创建一张图像并且观察出了什么问题。接下来，我们提出一个关于什么导致了问题的假设并且测试它。例如在一个光线追踪程序中，我们可能会有一些随机的看起来是黑色的像素。这是大多数人在写光线追踪器时会遇到的一个“阴影失真”的问题。传统的调试方法在这里并没有效果；我们必须认识到阴影的射线击中到被着色的表面上。我们还可能意识到，深色斑点的颜色是环境颜色，所以缺少了直接光照。在阴影中直接光照被关掉，所以你可能会假设这些点被错误地标记在了阴影中。为了验证这个假设，我们关闭阴影渲染并重新编译。这将推测出这些是错误的阴影测试导致的，并且我们能够继续我们的侦探工作。这个方法有的时候非常实用的关键原因是，我们不必找到错误的值或真的确定我们的概念错误。反而，我们只需要在实验中缩小我们的概念错误。通常只需要几次实验就能过解决错误，这种类型的调试通常是令人享受的。</p><p><strong>图片作为代码调试的输出</strong></p><p>在大部分情况中，在一个图形程序中获取调试信息最简单的方法就是输出图像本身。如果你想知道对于每个像素计算的一部分变量的值，你可以临时修改代码将值直接复制到输出图像并跳过通常需要完成的其他计算。例如，如果你怀疑表面法线的问题导致了渲染的错误，你可以直接将法线向量复制到图像（x 表示为红色，y 表示为绿色，z 表示为蓝色），这样你就得到了一个在你电脑中使用的向量的编码颜色图像。或者，如果你怀疑一个特定的值有时会超出其有效范围，让你的程序在错误发生的位置生成亮红色的像素。其他常用的技巧包括用明显的颜色绘制表面的背面（当它们不可见时），通过对象的 ID 编号来为其上色，或通过它们计算花费的工作量来为其上色。</p><p><strong>使用调试器</strong></p><p>仍然有一些情况，特别是当科学方法看起来会引发矛盾时，此时没有代替方法来直接观察到发生了什么。问题在于图形学程序通常涉及到相同代码的多次执行（例如每个像素执行一次，或每个三角形执行一次），使得从起点一步一步地进行调试变得完全不切实际。并且大部分的困难的 bug 通常只发生在复杂的输入。</p><p>一个有效的方法是为 bug 设置一些陷阱。首先，确保你的程序确定性地运行在单个线程中并且确保所有的随机数是从固定的种子中计算出的。接下来，找出哪个像素或三角形正在显示 bug 并在你怀疑是错误的代码前面添加语句，这些语句只会在可疑的位置被执行。例如如果你发现像素（126，247）显示了 bug，接下来添加：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>if x=126 and y=247 then
    print &quot;blarg&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果你在 print 语句上设置了一个断点，在计算你感兴趣的像素之前你能够进入调试器。一些调试器拥有“条件断点”的功能，能够无需添加上述代码也能完成相同的事。</p><p>在程序崩溃的情况下，传统的调试器对于查清崩溃的站点非常有效。你接下来应该在程序中开启断点，使用断言并重新编译来找出程序出错的位置。这些断言应该留在程序中，来避免你将来添加的潜在 bug。这再次说明了应该避免使用传统的步进程序，因为它不会为你的程序添加有效的断言。</p><p><strong>调试数据可视化</strong></p><p>通常很难理解你的程序正在做什么，因为它在最终出错之前计算了许多中间结果。这种情况类似于测量大量数据的科学实验，其中一个解决方案是相同的：为你自己制作精美的图表来帮你理解数据的含义。例如在光线追踪器中，你可能会编写代码来可视化射线树，这样你就能看到一个像素是由哪些路径贡献生成的，或者在一个图片重采样的程序中，你可能制作一张图表来展示所有的点是从输入中的哪些位置被采样的。花费在编写可视化程序的内部状态的代码会以对更好地理解程序行为的方式被偿还，尤其是需要花事情去优化代码的时候。</p><h2 id="notes" tabindex="-1"><a class="header-anchor" href="#notes" aria-hidden="true">#</a> Notes</h2><p>这里软件工程的讨论主要受到了 Effective C++ 系列（Meyers, 1995, 1997），Extreme Programming movement（Beck &amp; Andres, 2004）和 The Practice of Programming（Kernighan &amp; Pike, 1999）的影响。实验调试的讨论主要是建立在 Steve Parker 讨论的基础上。</p><p>有许多和计算机图形学相关的年度会议，例如 ACM SIGGRAPH and SIGGRAPH Asia，Graphics Interface，the Game Developers Conference（GDC），Eurographics，Paciﬁc Graphics，High Performance Graphics，the Eurographics Symposium on Rendering 和 IEEE VisWeek。可以通过网络搜索它们的名字立即找到它们。</p>`,20),J=[i,r,c,p,o,h,d,g,u,x,y,w,k,b,v,M,_,f,N,L,E,D,I,P,A,z,G,C,B,R,S,V,H,T,q];function O(W,K){return t(),e("div",null,J)}const X=n(m,[["render",O],["__file","01_Introduction.html.vue"]]);export{X as default};
